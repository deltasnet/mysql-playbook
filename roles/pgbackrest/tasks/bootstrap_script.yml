---

- block:  # Orchestrator cluster bootstrap script
    - name: Make sure the pgbackrest bootstrap script directory exist
      ansible.builtin.file:
        dest: /etc/Orchestrator
        state: directory
        owner: postgres
        group: postgres

    - name: Create /etc/Orchestrator/pgbackrest_bootstrap.sh script
      ansible.builtin.template:
        src: templates/pgbackrest_bootstrap.sh.j2
        dest: /etc/Orchestrator/pgbackrest_bootstrap.sh
        owner: postgres
        group: postgres
        mode: "0775"
  when:
    - Orchestrator_cluster_bootstrap_method is defined
    - Orchestrator_cluster_bootstrap_method == "pgbackrest"
    - "'postgres_cluster' in group_names"
  tags: pgbackrest, pgbackrest_bootstrap_script

...
